# üë§ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:

### 1. **–ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞**
   - ‚úÖ –í—ã–±–æ—Ä —Ñ–æ—Ç–æ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤ Supabase Storage
   - ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–º–µ–Ω—ã –∞–≤–∞—Ç–∞—Ä–∞

### 2. **–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è (—Å–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π)**
   - ‚úÖ –£—Ä–æ–≤–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤)
   - ‚úÖ –ë–∞–ª–ª—ã (10 –±–∞–ª–ª–æ–≤ –∑–∞ –∫–∞–∂–¥—ã–π –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑)
   - ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
   - ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏ –±–∞–ª–ª–æ–≤

### 3. **–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤**
   - ‚úÖ –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É (–í—Å–µ, –û–∂–∏–¥–∞–µ—Ç, –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω, –ó–∞–≤–µ—Ä—à–µ–Ω)
   - ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º –∑–∞–∫–∞–∑–µ
   - ‚úÖ Pull-to-refresh –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**
   - ‚úÖ –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
   - ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä email –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   - ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - ‚úÖ –í—ã–±–æ—Ä —è–∑—ã–∫–∞
   - ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase Storage –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å Storage Bucket

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard**: [https://supabase.com/dashboard](https://supabase.com/dashboard)
2. **–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç**
3. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤**: `Storage` ‚Üí `Buckets`
4. **–ù–∞–∂–º–∏—Ç–µ**: "New bucket"
5. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**:
   - **Name**: `avatars`
   - **Public bucket**: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ (—á—Ç–æ–±—ã –∞–≤–∞—Ç–∞—Ä—ã –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø—É–±–ª–∏—á–Ω–æ)
   - **File size limit**: 5 MB (–∏–ª–∏ –±–æ–ª—å—à–µ, –ø–æ –∂–µ–ª–∞–Ω–∏—é)
   - **Allowed MIME types**: `image/jpeg, image/png, image/webp`
6. **–ù–∞–∂–º–∏—Ç–µ**: "Create bucket"

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Storage Policies (RLS)

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤**: `Storage` ‚Üí `Policies` ‚Üí `avatars`
2. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏**:
   - **Policy name**: "Users can upload own avatars"
   - **Allowed operation**: INSERT
   - **Policy definition**:
   ```sql
   (bucket_id = 'avatars'::text) AND ((auth.uid())::text = (storage.foldername(name))[1])
   ```
   –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã —Ç–æ–ª—å–∫–æ –≤ —Å–≤–æ—é –ø–∞–ø–∫—É (`{userId}/`)

3. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è —á—Ç–µ–Ω–∏—è**:
   - **Policy name**: "Anyone can view avatars"
   - **Allowed operation**: SELECT
   - **Policy definition**:
   ```sql
   bucket_id = 'avatars'::text
   ```
   –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Å–µ–º –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∞–≤–∞—Ç–∞—Ä—ã (—Ç–∞–∫ –∫–∞–∫ bucket –ø—É–±–ª–∏—á–Ω—ã–π)

4. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**:
   - **Policy name**: "Users can update own avatars"
   - **Allowed operation**: UPDATE
   - **Policy definition**:
   ```sql
   (bucket_id = 'avatars'::text) AND ((auth.uid())::text = (storage.foldername(name))[1])
   ```

5. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è**:
   - **Policy name**: "Users can delete own avatars"
   - **Allowed operation**: DELETE
   - **Policy definition**:
   ```sql
   (bucket_id = 'avatars'::text) AND ((auth.uid())::text = (storage.foldername(name))[1])
   ```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
1. ‚úÖ Bucket `avatars` —Å–æ–∑–¥–∞–Ω
2. ‚úÖ Bucket –ø—É–±–ª–∏—á–Ω—ã–π
3. ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
4. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–≤–æ–∏ –∞–≤–∞—Ç–∞—Ä—ã

## üéÆ –°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π (–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è)

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- **1 –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑ = 10 –±–∞–ª–ª–æ–≤**
- **100 –±–∞–ª–ª–æ–≤ = 1 —É—Ä–æ–≤–µ–Ω—å**
- **–£—Ä–æ–≤–µ–Ω—å 1**: 0-99 –±–∞–ª–ª–æ–≤
- **–£—Ä–æ–≤–µ–Ω—å 2**: 100-199 –±–∞–ª–ª–æ–≤
- **–£—Ä–æ–≤–µ–Ω—å 3**: 200-299 –±–∞–ª–ª–æ–≤
- –ò —Ç–∞–∫ –¥–∞–ª–µ–µ...

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
- –ë–µ–π–¥–∂ —Å —Ç–µ–∫—É—â–∏–º —É—Ä–æ–≤–Ω–µ–º
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `image_picker` –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
flutter pub get
```

## üì± –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º

### Android (android/app/src/main/AndroidManifest.xml):
```xml
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.CAMERA"/>
```

### iOS (ios/Runner/Info.plist):
```xml
<key>NSPhotoLibraryUsageDescription</key>
<string>–ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –≥–∞–ª–µ—Ä–µ–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞</string>
<key>NSCameraUsageDescription</key>
<string>–ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –¥–ª—è —Ñ–æ—Ç–æ –∞–≤–∞—Ç–∞—Ä–∞</string>
```

## ‚úÖ –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. ‚úÖ Supabase Storage bucket —Å–æ–∑–¥–∞–Ω
2. ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
3. ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (`flutter pub get`)
4. ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã (–¥–ª—è Android/iOS)
5. ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ

–¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç:
- üì∏ –ó–∞–≥—Ä—É–∂–∞—Ç—å –∞–≤–∞—Ç–∞—Ä—ã
- üéÆ –í–∏–¥–µ—Ç—å —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –∏ –±–∞–ª–ª—ã
- üìã –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤
- ‚öôÔ∏è –ú–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

## üé® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ UI

- **–ö—Ä–∞—Å–∏–≤—ã–π –¥–∏–∑–∞–π–Ω –ø—Ä–æ—Ñ–∏–ª—è** —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
- **–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** –¥–ª—è —É—Ä–æ–≤–Ω–µ–π
- **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏** —Å –∏–∫–æ–Ω–∫–∞–º–∏
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤** –ø–æ —Å—Ç–∞—Ç—É—Å—É
- **Pull-to-refresh** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ —ç–∫—Ä–∞–Ω–∞

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ï—Å–ª–∏ –∞–≤–∞—Ç–∞—Ä –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ bucket `avatars` —Å–æ–∑–¥–∞–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Supabase Dashboard: `Logs` ‚Üí `Storage Logs`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ bucket –ø—É–±–ª–∏—á–Ω—ã–π

### –ï—Å–ª–∏ —É—Ä–æ–≤–Ω–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –µ—Å—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã (`status = 'completed'`)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
